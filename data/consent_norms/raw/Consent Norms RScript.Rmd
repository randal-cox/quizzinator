---
title: "Consent Norms Script"
output: word_document
date: "2024-09-06"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Setup

Required packages:

- readr
- psych
- plyr
- jmv
- stats
- reshape2
- afex
- plyr
- ggplot2

```{r import}
# import and rename dataset
consent <- readr::read_csv("insert filepath here")
```

```{r setupData}
# Changing accidental 8s in PuPBottomAdd to 7s

consent$PuPBottomAdd <- consent$PuPBottomAdd*(consent$PuPBottomAdd != 8) +
  7*(consent$PuPBottomAdd == 8)

# Make Participant into a factor (needed for aov_car)

consent$Participant <- factor(consent$Participant)

## Recode demographics 

# Gender
  # 3 = gender expansive, 2 = woman, 1 = man
consent$GenderCode <- ifelse(!is.na(consent$Nonbinary), 3,
                             ifelse(!is.na(consent$Gendernonconforming), 3,
                                     ifelse(!is.na(consent$Genderfluid), 3,
                                           ifelse(!is.na(consent$Genderqueer), 3, 
                                                  ifelse(!is.na(consent$TwoSpirit), 3,
                                                         ifelse(!is.na(consent$Intersex), 3,
                                                                ifelse(!is.na(consent$Agender), 3,
                                                                       ifelse(!is.na(consent$OtherGender), 3,
                                                                              ifelse(!is.na(consent$Male), 1,
                                                                                     ifelse(!is.na(consent$Transman), 1, 2))))))))))

# Sexual Orientation
  # gender orientation
  # 1 = straight & heteroflexible, 2 = gay & homoflexible, 3 = bisexual & pansexual, 0 = n/a
consent$gayCode <-
  ifelse(!is.na(consent$Pansexual), 3,
         ifelse(!is.na(consent$Bisexual), 3,
                ifelse(!is.na(consent$Heterosexual), 1,
                       ifelse(!is.na(consent$Gay), 2,
                          ifelse(!is.na(consent$Heteroflexible), 1,
                                 ifelse(!is.na(consent$Homoflexible), 2, 0
                        ))))))

  # asexuality
  # 1 = ace spectrum (asexuality, aromantic, demisexual, graysexual), 2 = allosexual/non-ace spectrum
consent$aceCode <- ifelse(!is.na(consent$Aromantic), 1,
                          ifelse(!is.na(consent$Aromantic), 1,
                                 ifelse(!is.na(consent$Demisexual), 1,
                                        ifelse(!is.na(consent$Greysexual), 1, 2))))

# Time in kink
consent$kinkTime <- consent$Age - consent$FirstKinkAge

# BDSM Role
  # 3 = switch, 2 = follower, 1 = leader 
consent$roleCode <-
  1*((!is.na(consent$Top) | !is.na(consent$Master) | !is.na(consent$Dominant))
     & is.na(consent$Switch) & is.na(consent$Bottom) & is.na(consent$Slave) & is.na(consent$Submissive)) +
  2*((!is.na(consent$Bottom) | !is.na(consent$Slave) | !is.na(consent$Submissive))
     & is.na(consent$Switch) & is.na(consent$Top) & is.na(consent$Master) & is.na(consent$Dominant)) +
  3*(!is.na(consent$Switch) |
       ((!is.na(consent$Top) | !is.na(consent$Master) | !is.na(consent$Dominant)) &
          (!is.na(consent$Bottom) | !is.na(consent$Slave) | !is.na(consent$Submissive))))
consent$roleCode[consent$roleCode == 0] <- NA
```

## Demographics

```{r descriptives}
# Age
psych::describe(consent$Age)

# Time in kink
psych::describe(consent$kinkTime)

# Gender
plyr::count(consent$GenderCode)

# Race
plyr::count(consent$RaceCode)

# Sexual orientation
  # Gender orientation
plyr::count(consent$gayCode)
  # Asexuality
plyr::count(consent$aceCode)

# BDSM role
plyr::count(consent$roleCode)
```

```{r genderXrole}
jmv::contTables(formula = ~ GenderCode:roleCode, data = consent)
```

## H1: Communication standards will be more stringent regarding pick-up play scenes compared to scenes in the context of romantic reltaionships. 

# t-tests
- Importance of explicitly establishing a safeword
- Extent of negotiations
- Acceptability of jumping into a scene
- Adequacy of relying on nonverbal cues
- Is it okay to attempt activities not discussed

```{r descriptives}
# Safeword
psych::describe(consent$PuPSafeword)
psych::describe(consent$RRSafeword)

# Negotiation
psych::describe(consent$PuPNegotiation)
psych::describe(consent$RRNegotiation)

#Jump
psych::describe(consent$PuPjump)
psych::describe(consent$RRjump)

# Nonverbal
psych::describe(consent$PuPnonverbal)
psych::describe(consent$RRnonverbal)

#Safeword not discussed
psych::describe(consent$PuPsafewordNotDiscussed)
psych::describe(consent$RRsafewordNotDiscussed)
```

```{r t-test}
#Safeword
safeword <- stats::t.test(consent$PuPSafeword, consent$RRSafeword, paired = TRUE)
safeword

#Negotiation
negotiation <- stats::t.test(consent$PuPNegotiation, consent$RRNegotiation, paired = TRUE)
negotiation

#Jump
jump <- stats::t.test(consent$PuPjump, consent$RRjump, paired = TRUE)
jump

#Nonverbal
nonverbal <- stats::t.test(consent$PuPnonverbal, consent$RRnonverbal, paired = TRUE)
nonverbal

#Safeword Not Discussed
discussed <- stats::t.test(consent$PuPsafewordNotDiscussed, consent$RRsafewordNotDiscussed, paired = TRUE)
discussed
```

# Renegotiate ANOVA
- acceptability of either the top/bottom adding/removing activities during a pickup play/romantic relationship scene

```{r setup}
# Select only the columns of the dataset that we'll be using for the Add/Remove question.
# I use na.omit to remove anyone with missing data on these variables

consentAddRemove <- na.omit(consent[c("Participant",
                              "PuPBottomAdd","PuPBottomRemove",
                              "PuPTopAdd","PuPTopRemove",
                              "RRBottomAdd","RRBottomRemove",
                              "RRTopAdd","RRTopRemove")])


# Melt the data frame into long format

consentAddRemoveLong <- reshape2::melt(consentAddRemove, id = c("Participant"),
                                measured = c("PuPBottomAdd","PuPBottomRemove",
                                             "PuPTopAdd","PuPTopRemove",
                                              "RRBottomAdd","RRBottomRemove",
                                              "RRTopAdd","RRTopRemove"))

# Rename the new columns

colnames(consentAddRemoveLong)[2] <- "Measure"
colnames(consentAddRemoveLong)[3] <- "Acceptable"

# Create the new independent variables

consentAddRemoveLong$Role <- 1*((consentAddRemoveLong$Measure == "PuPTopAdd") |
  (consentAddRemoveLong$Measure == "PuPTopRemove") |
  (consentAddRemoveLong$Measure == "RRTopAdd") |
  (consentAddRemoveLong$Measure == "RRTopRemove"))

consentAddRemoveLong$Direction <- 1*((consentAddRemoveLong$Measure == "PuPTopAdd") |
  (consentAddRemoveLong$Measure == "PuPBottomAdd") |
  (consentAddRemoveLong$Measure == "RRTopAdd") |
  (consentAddRemoveLong$Measure == "RRBottomAdd"))

consentAddRemoveLong$Relationship <- 1*((consentAddRemoveLong$Measure == "RRTopAdd") |
  (consentAddRemoveLong$Measure == "RRBottomAdd") |
  (consentAddRemoveLong$Measure == "RRTopRemove") |
  (consentAddRemoveLong$Measure == "RRBottomRemove"))

consentAddRemoveLong$Role <- factor(consentAddRemoveLong$Role, levels = c(0,1),
                                    labels = c("Bottom","Top"))
consentAddRemoveLong$Direction <- factor(consentAddRemoveLong$Direction, levels = c(0,1),
                                    labels = c("Remove","Add"))
consentAddRemoveLong$Relationship <- factor(consentAddRemoveLong$Relationship, levels = c(0,1),
                                         labels = c("Pick-up-play","Romantic"))
```

```{r ANOVA}
# Run the 2x2x2 within-subject ANOVA and display the results

AddRemoveANOVA <- afex::aov_car(Acceptable ~ Role*Direction*Relationship + 
                            Error(Participant/Role*Direction*Relationship), 
                        data = consentAddRemoveLong,
                        anova_table = list(es="pes", correction = "none"))
AddRemoveANOVA
summary(AddRemoveANOVA)
```

```{r simpleEffects}
consentAddLong <- subset(consentAddRemoveLong, 
                            consentAddRemoveLong$Direction == "Add")
AddANOVA <- aov_car(Acceptable ~ Role*Relationship + 
                         Error(Participant/Role*Relationship), 
                       data = consentAddLong,
                       anova_table = list(es="pes", correction = "none"))
AddANOVA
summary(AddANOVA)
```

```{r means}

stats::aggregate(consentAddRemoveLong$Acceptable, list(consentAddRemoveLong$Role), FUN=mean)

stats::aggregate(consentAddRemoveLong$Acceptable, list(consentAddRemoveLong$Direction), FUN=mean)

stats::aggregate(consentAddRemoveLong$Acceptable, list(consentAddRemoveLong$Relationship), FUN=mean)

stats::aggregate(consentAddRemoveLong$Acceptable, list(consentAddRemoveLong$Role,
                                              consentAddRemoveLong$Direction),
          FUN=mean)

stats::aggregate(consentAddRemoveLong$Acceptable, list(consentAddRemoveLong$Role,
                                                consentAddRemoveLong$Relationship),
          FUN=mean)

stats::aggregate(consentAddRemoveLong$Acceptable, list(consentAddRemoveLong$Direction,
                                                consentAddRemoveLong$Relationship),
          FUN=mean)

stats::aggregate(consentAddRemoveLong$Acceptable, list(consentAddRemoveLong$Role,
                                                consentAddRemoveLong$Direction,
                                            consentAddRemoveLong$Relationship),
          FUN=mean)
```

```{r graph}
addRemSum <- plyr::ddply(consentAddRemoveLong, "Measure", summarise, 
                 N = length(Acceptable),
                 mean = mean(Acceptable),
                 sd = sd(Acceptable),
                 se = sd / sqrt(N))
addRemSum$Relationship <- c("Pick-up Play", "Pick-up Play", "Pick-up Play", "Pick-up Play", "Romantic", "Romantic", "Romantic", "Romantic")
addRemSum$Role <- c("Bottom", "Bottom", "Top", "Top","Bottom", "Bottom", "Top", "Top")
addRemSum$Direction <- c("Add", "Remove","Add", "Remove","Add", "Remove","Add", "Remove")

ggplot2::ggplot(addRemSum, aes(x = Relationship, y = mean, fill = Role)) + 
    geom_bar(stat = "identity", position = "dodge") +
  geom_errorbar(aes(x = Relationship, ymax= mean + se, ymin = mean-se), position = position_dodge(width=0.9), width = .2) +
  labs(title = "Figure 1", 
       subtitle = "Acceptability of Renegotiating During a Scene", 
       x = "Relationship",
       y = "Acceptability") +
  coord_cartesian(ylim = c(1, 7)) +
  scale_y_continuous(limits = c(0,7), breaks = seq(1,7, by = 1),expand = c(0,0)) +
    facet_grid(~ Direction) +
  theme_apa()
```

exploratory moderation; does BDSM role moderate?

```{r setup}
# Select only the columns of the dataset that we'll be using for the Add/Remove questions.
# I use na.omit to remove anyone with missing data on these variables

AddRemoveRole <- na.omit(consent[c("Participant",
                              "PuPBottomAdd","PuPBottomRemove",
                              "PuPTopAdd","PuPTopRemove",
                              "RRBottomAdd","RRBottomRemove",
                              "RRTopAdd","RRTopRemove","roleCode")])


# Melt the data frame into long format

AddRemoveRoleLong <- reshape2::melt(AddRemoveRole, id = c("Participant","roleCode"),
                                measured = c("PuPBottomAdd","PuPBottomRemove",
                                             "PuPTopAdd","PuPTopRemove",
                                              "RRBottomAdd","RRBottomRemove",
                                              "RRTopAdd","RRTopRemove"))

# Rename the new columns

colnames(AddRemoveRoleLong)[3] <- "Measure"
colnames(AddRemoveRoleLong)[4] <- "Acceptable"

# Create the new independent variables

AddRemoveRoleLong$Role <- 1*((AddRemoveRoleLong$Measure == "PuPTopAdd") |
  (AddRemoveRoleLong$Measure == "PuPTopRemove") |
  (AddRemoveRoleLong$Measure == "RRTopAdd") |
  (AddRemoveRoleLong$Measure == "RRTopRemove"))

AddRemoveRoleLong$Direction <- 1*((AddRemoveRoleLong$Measure == "PuPTopAdd") |
  (AddRemoveRoleLong$Measure == "PuPBottomAdd") |
  (AddRemoveRoleLong$Measure == "RRTopAdd") |
  (AddRemoveRoleLong$Measure == "RRBottomAdd"))

AddRemoveRoleLong$Relationship <- 1*((AddRemoveRoleLong$Measure == "RRTopAdd") |
  (AddRemoveRoleLong$Measure == "RRBottomAdd") |
  (AddRemoveRoleLong$Measure == "RRTopRemove") |
  (AddRemoveRoleLong$Measure == "RRBottomRemove"))



AddRemoveRoleLong$Role <- factor(AddRemoveRoleLong$Role, levels = c(0,1),
                                    labels = c("Bottom","Top"))
AddRemoveRoleLong$Direction <- factor(AddRemoveRoleLong$Direction, levels = c(0,1),
                                    labels = c("Remove","Add"))
AddRemoveRoleLong$Relationship <- factor(AddRemoveRoleLong$Relationship, levels = c(0,1),
                                         labels = c("Pick-up-play","Romantic"))
```

```{r moderation}
mod <- afex::aov_car(Acceptable ~ Role*Direction*Relationship*roleCode+ 
                            Error(Participant/Role*Direction*Relationship), 
                        data = AddRemoveRoleLong,
                        anova_table = list(es="pes", correction = "none"))
mod
summary(mod)
```

# Intoxication ANOVA
- acceptability of consenting to top/bottom for a pickup play/romantic relationship scene while impaired by recreational drugs or alcohol

```{r setup}
# Select only the columns of the dataset that we'll be using for the intoxication question.
# I use na.omit to remove anyone with missing data on these variables

consentPuPRRdrugsUnmelted <- na.omit(consent[c("Participant",
                              "PuPtopDrugs", "PuPbottomDrugs", "RRtopDrugs", "RRbottomDrugs")])

# Melt the data frame into long format
consentPuPRRdrugs <- reshape2::melt(consentPuPRRdrugsUnmelted, id = c("Participant"),
                                measured = c("PuPtopDrugs", "PuPbottomDrugs", "RRtopDrugs", "RRbottomDrugs"))

# Rename the new columns

colnames(consentPuPRRdrugs)[2] <- "Measure"
colnames(consentPuPRRdrugs)[3] <- "Acceptable"

# Create the new independent variables

consentPuPRRdrugs$Role <- 1*((consentPuPRRdrugs$Measure == "RRtopDrugs") |
  (consentPuPRRdrugs$Measure == "PuPtopDrugs"))

consentPuPRRdrugs$Relationship <- 1*((consentPuPRRdrugs$Measure == "RRtopDrugs") |
  (consentPuPRRdrugs$Measure == "RRbottomDrugs"))


consentPuPRRdrugs$Role <- factor(consentPuPRRdrugs$Role, levels = c(0,1),
                                    labels = c("Bottom","Top"))
consentPuPRRdrugs$Relationship <- factor(consentPuPRRdrugs$Relationship, levels = c(0,1),
                                         labels = c("Pick-up-play","Romantic"))

```

```{r ANOVA}
# run ANOVA and display results
PuPrrDrugANOVA <- afex::aov_car(Acceptable ~ Role*Relationship + 
                            Error(Participant/Role*Relationship), 
                        data = consentPuPRRdrugs,
                        anova_table = list(es="pes", correction = "none"))
PuPrrDrugANOVA
summary(PuPrrDrugANOVA)
```

```{r means}
stats::aggregate(consentPuPRRdrugs$Acceptable, list(consentPuPRRdrugs$Role), FUN=mean)

stats::aggregate(consentPuPRRdrugs$Acceptable, list(consentPuPRRdrugs$Relationship), FUN=mean)

stats::aggregate(consentPuPRRdrugs$Acceptable, list(consentPuPRRdrugs$Role,
                                              consentPuPRRdrugs$Relationship),
          FUN=mean)

```

```{r graph}
drugSum <- plyr::ddply(consentPuPRRdrugs, "Measure", summarise, 
                 N = length(Acceptable),
                 mean = mean(Acceptable),
                 sd = sd(Acceptable),
                 se = sd / sqrt(N))
drugSum$Relationship <- c("Pick-up Play", "Pick-up Play", "Romantic", "Romantic")
drugSum$Role <- c("Top", "Bottom", "Top", "Bottom")

ggplot2::ggplot(drugSum, aes(x = Relationship, y = mean, fill = Role)) + 
    geom_bar(stat = "identity", position = "dodge") +
  geom_errorbar(aes(x = Relationship, ymax= mean + se, ymin = mean-se), position = position_dodge(width=0.9), width = .2) +
  labs(title = "Figure 2", 
       subtitle = "Acceptability of Consent While Impaired", 
       x = "Relationship",
       y = "Acceptability") +
   coord_cartesian(ylim = c(1, 7)) +
  scale_y_continuous(limits = c(0,7), breaks = seq(1,7, by = 1), expand = c(0,0)) +
  theme_apa()
```

## H2: Consent communication standards will be more stringent in new relationships compared to ongoing relationships.

# t-test
- How often do you have a mutually agreed upon safeword with a new/existing partner?

```{r descriptives}
#Safeword new v existing
psych::describe(consent$SafewordNew)
psych::describe(consent$SafewordExist)
```

```{r t-test}
#Safeword new v. existing
newExisting <- stats::t.test(consent$SafewordNew, consent$SafewordExist, paired = TRUE)
newExisting
```

# Intoxication ANOVA
- How intoxicated can a person be and consent to non-BDSM sex/a BDSM scene in the context of a new/existing relationship?

```{r setup}
# Select only the columns of the dataset that we'll be using for the new/existing intoxication question.
# I use na.omit to remove anyone with missing data on these variables

consentAlcoholNewExist <- na.omit(consent[c("Participant",
                              "IntoxicatedBDSMnew", "IntoxicatedBDSMexist", "IntoxicatedVanNew", "IntoxicatedVanExist")])

# Melt the data frame into long format
consentAlcoholNewExistLong <- reshape2::melt(consentAlcoholNewExist, id = c("Participant"),
                                measured = c( "IntoxicatedBDSMnew", "IntoxicatedBDSMexist", "IntoxicatedVanNew", "IntoxicatedVanExist"))

# Rename the new columns

colnames(consentAlcoholNewExistLong)[2] <- "Measure"
colnames(consentAlcoholNewExistLong)[3] <- "Acceptable"

# Create the new independent variables

consentAlcoholNewExistLong$Kink <- 1*((consentAlcoholNewExistLong$Measure == "IntoxicatedBDSMnew") |
  (consentAlcoholNewExistLong$Measure == "IntoxicatedBDSMexist"))

consentAlcoholNewExistLong$Relationship <- 1*((consentAlcoholNewExistLong$Measure == "IntoxicatedBDSMexist") |
  (consentAlcoholNewExistLong$Measure == "IntoxicatedVanExist"))


consentAlcoholNewExistLong$Kink <- factor(consentAlcoholNewExistLong$Kink, levels = c(0,1), labels = c("Vanilla","BDSM"))

consentAlcoholNewExistLong$Relationship <- factor(consentAlcoholNewExistLong$Relationship, levels = c(0,1),
                                         labels = c("New","Existing"))
```

```{r ANOVA}
# run ANOVA and display results
AlcoholANOVA <- afex::aov_car(Acceptable ~ Kink*Relationship + 
                            Error(Participant/Kink*Relationship), 
                        data = consentAlcoholNewExistLong,
                        anova_table = list(es="pes", correction = "none"))
AlcoholANOVA
summary(AlcoholANOVA)
```

```{r means}
stats::aggregate(consentAlcoholNewExistLong$Acceptable, list(consentAlcoholNewExistLong$Kink), FUN=mean)

stats::aggregate(consentAlcoholNewExistLong$Acceptable, list(consentAlcoholNewExistLong$Relationship), FUN=mean)

stats::aggregate(consentAlcoholNewExistLong$Acceptable, list(consentAlcoholNewExistLong$Kink,
                                              consentAlcoholNewExistLong$Relationship),
          FUN=mean)
```

```{r graph}
alcSum <- plyr::ddply(consentAlcoholNewExistLong, "Measure", summarise, 
                 N = length(Acceptable),
                 mean = mean(Acceptable),
                 sd = sd(Acceptable),
                 se = sd / sqrt(N))

alcSum$Context <- c("BDSM Scene", "BDSM Scene", "Vanilla Sex", "Vanilla Sex")
alcSum$Relationship <- c("New Relationship", "Existing Relationship", "New Relationship", "Existing Relationship")

ggplot2::ggplot(alcSum, aes(x = Context, y = mean, fill = Relationship)) + 
    geom_bar(stat = "identity", position = "dodge") +
  geom_errorbar(aes(x = Context, ymax= mean + se, ymin = mean-se), position = position_dodge(width=0.9), width = .2) +
  labs(title = "Figure 3", 
       subtitle = "Acceptable Intoxication Level for Consent", 
       x = "Context",
       y = "Intoxication") +
   coord_cartesian(ylim = c(1, 5)) +
  scale_y_continuous(limits = c(0,5), breaks = seq(1,5, by = 1), expand = c(0,0)) +
  theme_apa()
```

## Exploratory Analyses

# When do negotiations matter more?
- Kink v. non-Kink activities
- Riskier activities

```{r descriptives}
# kink v. non-kink activities
psych::describe(consent$ExpNegKinkVan)

# riskier activities
psych::describe(consent$ExpNegRisk)
```

```{r t-tests}
# kink v. non-kink activities
stats::t.test(consent$ExpNegKinkVan, mu = 4, alternative = "two.sided")

# riskier activities
stats::t.test(consent$ExpNegRisk, mu = 4, alternative = "two.sided")
```

# Consent education

```{r setup}
# aggregate variables

## Stringent
# scale function to standardize, add positive code, subtract reverse code, average

consent$stringent <- (scale(consent$PuPNegotiation) + scale(consent$RRNegotiation) + scale(consent$RRSafeword) + scale(consent$PuPSafeword) + scale(consent$PuPBottomRemove) + scale(consent$PuPTopRemove) + scale(consent$RRBottomRemove) + scale(consent$RRTopRemove) - scale(consent$PuPjump) - scale(consent$RRjump) - scale(consent$PuPnonverbal) - scale(consent$RRnonverbal) - scale(consent$PuPsafewordNotDiscussed) - scale(consent$RRsafewordNotDiscussed) - scale(consent$PuPtopDrugs) - scale(consent$PuPbottomDrugs) - scale(consent$RRtopDrugs) - scale(consent$RRbottomDrugs))/18

# create factor for consent education
consent$consentCode <- factor(consent$ConsentCode, levels = c(0,2), labels = c("no", "kink"))
# NOTE: ConsentCode is not a factor. consentCode is a factor.

## Safeword New/Exist
consent$safewordNewExist <- (scale(consent$SafewordNew) + scale(consent$SafewordExist))/2
```

```{r descriptives}
# 2 = had consent ed in kink setting, 0 = did not have formal consent ed in kink setting
plyr::count(consent$ConsentCode)

# hand calculating because easier, not counting NAs
132/(132+66)

# means of "stringent" aggregate variable across consent education groups
psych::describeBy(consent$stringent, group = consent$consentCode)

# Levene Test
# not significant so can assume equal variances
car::leveneTest(as.numeric(stringent) ~ consentCode,center=median, data = consent)

# means of safeword new/exist across consent education groups
psych::describeBy(consent$safewordNewExist, group = consent$consentCode)
```

```{r t-tests}
# Do people with formal kink consent education have more stringent consent norms?
education <- stats::t.test(stringent ~ consentCode, data = consent, var.equal = TRUE)
education

# Do people with formal kink consent education have mutually agreed upon safwords more often? 
safewordT <- stats::t.test(safewordNewExist ~ consentCode, data = consent,  var.equal = TRUE)
safewordT
```

# Violation of limits
- Have you ever had a prenegotiated limit violated in a BDSM scene/vanilla sexual encounter?

```{r setup}
# subset variables of interest
violateTest <- consent[c("Participant", "ViolateLimitBDSM", "ViolateBoundaryVanilla", "roleCode", "GenderCode")]

# remove unsures
violateTest$ViolateLimitBDSM <- na_if(violateTest$ViolateLimitBDSM, "3")
violateTest$ViolateBoundaryVanilla <- na_if(violateTest$ViolateBoundaryVanilla, "3")
violateTest <- na.omit(violateTest[c("Participant", "ViolateLimitBDSM", "ViolateBoundaryVanilla")])
```

```{r descriptives}
# 1 = yes, 2 = no, 3 = unsure

## Overall Sample

# Have you ever had a prenegotiated limit violated in a BDSM scene?
psych::describe(consent$ViolateLimitBDSM)
plyr::count(consent$ViolateLimitBDSM)

# Have you ever had a negotiated boundary violated in a vanilla sexual encounter?
psych::describe(consent$ViolateBoundaryVanilla)
plyr::count(consent$ViolateBoundaryVanilla)


## Subset

# Have you ever had a prenegotiated limit violated in a BDSM scene?
psych::describe(violateTest$ViolateLimitBDSM)
plyr::count(violateTest$ViolateLimitBDSM)

# Have you ever had a negotiated boundary violated in a vanilla sexual encounter?
psych::describe(violateTest$ViolateBoundaryVanilla)
plyr::count(violateTest$ViolateBoundaryVanilla)

```

```{r mcNemarTest}
stats::mcnemar.test(table(violateTest$ViolateLimitBDSM, violateTest$ViolateBoundaryVanilla), correct = FALSE)

table(violateTest$ViolateLimitBDSM, violateTest$ViolateBoundaryVanilla)
```
